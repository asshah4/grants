---
title: Autonomic and Structural Mechanisms in Atrial Fibrillation
subtitle: T32/TPIPCVM Seminar
date: December 18, 2023
date-format: full
author: Anish S. Shah, MD | MS
institute: 
- Division of Cardiology, University of Illinois Chicago 
- Rollins School of Public Health, Emory University
format: 
  revealjs:
    scrollable: true
    navigation-mode: linear
    slide-number: true
revealjs-plugins:
  - attribution
tbl-cap-location: bottom
fig-cap-location: bottom
---

```{r}
#| label: setup
#| echo: false
library(tidyverse)
library(gt)
library(ggsci)
library(scales)
library(ggdag)
library(shiva)
library(hrd)
```

# Introduction

## {.tiny}

| Abbreviations | Definitions |
| - | --- |
| (p)AF | (paroxysmal) atrial fibrillation |
| AAD | anti-arrhythmic drugs |
| ANS/SNS/PNS | autonomic/sympathetic/parasympathetic nervous sytem |
| CAD, MI | coronary artery disease, myocardial ischemia/infarction |
| EPS, EAM | electrophysiology study, electro-anatomical mapping |
| GP | ganglionated plexi |
| HF, LF HRV | high & low frequency heart rate variability |
| LA, RA, LV, RV | left/right atrium/ventricle |
| NPY, Gal | neuropeptide Y, galanin |
| VNS | vagal nerve stimulation |

---

_A consistent color scheme is provided throughout._

. . .

- [Computational]{.green} & [digital signal processing]{.green} methods will be noted in [green]{.green}
- [Clinical data]{.red} that requires a physician or cardiologist to obtain are noted in [red]{.red}
- [Arrhythmia]{.yellow} and [electrical]{.yellow} focused work is noted in [yellow]{.yellow}
- [Epidemiological]{.blue} or [genetic]{.blue} based methods are noted in [blue]{.blue}

## Objectives

a. Know the general clinical mechanisms in arrhythmogenesis
a. Differentiate between substrate and trigger contributions 
a. Understand methods to evaluate structural changes 
a. Recognize autonomic influences on arrhythmogenesis

## Outline {.tiny}

1. Historical context of atrial fibrillation
1. Importance of both autonomic, structural, and triggered factors
	a. Coumel's triangle of arrhythmology
	a. Comparative anatomy and physiology
1. [Substrate considerations in arrhythmic risk]{.green}
	a. Phenotyping substrates
	a. Genetic variants in atrial myopathy
1. [Autonomic influences in arrhythmic risk]{.yellow}
	a. Neurocardiac axis and stress pathways
	a. Role of genetics
1. [Future directions]{.red}

# Historical Context

## Atrial fibrillation overview

*A supraventricular tachyarrhythmia characterized by uncoordinated atrial activation with subsequent deterioration of atrial mechanical function*

- Most common sustained arrhythmia in adults
- ~40% develop AF after age of 55 years
- Risk factors include: age, CAD, male sex, European ancestry, hypertension, obesity, smoking, sleep apnea, family history of AF in relatives
- 20% of new diagnoses are secondary to acute precipitant (e.g. surgery, pneumonia)

---

![The progression after developing AF can be cyclical, such that __AF begets AF__, adapted from @Rivner2020](../figures/rivner-2020-af-begets-af.png){#fig-af-begets-af}

---

![@Packer2020 describes how AF can be preceded by atrial myopathy, predominantly seen with enlarged left atria due to atrial mechanical dysfunction.](../figures/packer-2020-atrial-myopathy.png){#fig-atrial-myopathy}

## Comparative physiology

- Larger atria are seen in larger mammals, such as elephants and whales
- Prevalence of AF is not consistently associated with atrial size
- Atrial fibrillation is the most common cardiac abnormality in horses [@Decloedt2020], but rare in underwater mammals
- Atrial arrhythmias in aquatic mammals are related to diving (baroreceptor and diving reflexes) [@Williams2015]

*Is there more to atrial fibrillation than atrial size?*

---

![Atrioventricular conduction is a consequence of overall mass (and cardiac mass), due to allometric scaling, @Meijler1985](../figures/meijler-1985-comparative-av-conduction.png){#fig-comparative-av-conduction}

---

![An example strip of a humpback whale, with visible P waves, obtained by @Meijler1992](../figures/meijler-1992-whale-ecg-strip.png){#fig-whale-ecg-strip}

---

![Signal-averaged ECG showing a PR interval of 400 ms, a QRS duration of 200 ms, and a QT interval of 700 ms, generated by @Meijler1992](../figures/meijler-1992-whale-signal-averaged-ecg.png){#fig-whale-signal-averaged-ecg}

## Arrhythmia mechanisms

*Multiple mechanisms are at play in AF simultaneously in AF, and may manifest in a similar fashion.*

@Antzelevitch2012:

- Re-entry *functionally* or around scar/fibrosis
- Local firing due to increased/enhanced automaticity
- Triggered activity due to early or delayed afterdepolarizations

---

![Types and triggers of AF, adapted from @Michaud2021](../figures/michaud-2021-af-types.png){#fig-af-types}

---

![Basic mechanisms of arrhythmia adapted from @Grune2021](../figures/grune-2021-arrhythmia-mechanisms.png){#fig-arrhythmia-mechanisms}

## Coumel's triangle

```{r}
#| label: fig-coumel-simple
#| fig-cap: "Simplified Coumel's triangle"
dag <- 
	dagify(
	ans ~~ substrate,
	trigger ~~ ans,
	substrate ~~ trigger,
	exposure = 'ans',
	outcome = 'substrate',
	labels = list(
		ans = 'Autonomic Factors',
		trigger = 'Pulmonary and Extrapulmonary Triggers',
		substrate = 'Atrial Substrate'
	)
) |>
	tidy_dagitty(layout = 'tree') |>
	node_status()

ggplot(dag, aes(x = x, y = y, xend = xend, yend = yend, color = status)) +
	geom_dag_edges(
		#arrow_directed = grid::arrow(length = grid::unit(20, "pt"), type = "closed"),
		arrow_bidirected = grid::arrow(length = grid::unit(20, "pt"), type = "closed", ends = "both"),
		edge_alpha = 0.9,
		curvature = 0.0
	) +
	geom_dag_point(size = 20) +
	geom_dag_label_repel(
		aes(label = label),
		force = 0,
		alpha = 0.9,
		size = 8 
	) +
	scale_color_manual(values = c("exposure" = "#f0941f", "outcome" = "#196774"), na.value = "#363432") +
	theme_dag(legend.position = "none")
```

---

![Coumel's triangle for AF from @Cheniti2018](../figures/cheniti-2018-coumel-triangle.jpg){#fig-coumel-complex}

## Differential contributions {.smaller}

- Spectrum between trigger-predominant and substrate-predominant
- Length of episodes of AF are related to both triggers and substrate
	- *Staccato* subtypes are short and frequent, but predominantly in lower-burden patients
	- *Legato* subtypes are long and infrequent, but predominantly in higher-burden patients
- Underlying mechanism of arrhythmia likely vary between these types in terms of **onset** and **maintenance** of arrhythmia

---

![Atrial fibrillation burden and episode duration are distinct, and subtypes exist. *Legato* is in upper left, and *staccato* is in lower right. Adapted from @Wineinger2019](../figures/wineinger-2019-paf-duration-subtypes.png){#fig-paf-duration-subtypes}

# Substrate Considerations

## Fibrosis and scar

- AF is sustained predominantly through [re-entry mechanisms]{.yellow}
- Scar and low-voltage areas become regions for functional re-entry
- Therapeutic strategies have targeted limiting the available area for re-entry to occur [@Calkins2017]
	- Catheter ablation, with 60-90% 1-year AF-free survival 
	- Surgical maze procedure, with 80% success

---

![Multimodal imaging approaches are available to visualize fibrosis and scar in the atria, @Goldberger2015](../figures/goldberger-2015-atrial-imaging.png){#fig-atrial-imaging}

---

![Clinically, low-voltage areas, potential surrogates for scar and fibrosis, can be visualized during electrophysiology studies.](../figures/goldberger-2015-la-voltage-map.png)

---

![Low voltage areas can be quantified via MRI, such as by the Utah Criteria (@Mahnkopf2010)](../figures/mahnkopf-2010-utah-criteria.png){#fig-utah-criteria}

## Genetic influences on substrate {.tiny}

- A modifier of cardiac substrate are genetic variants
- @Choi2018 identified TTN loss-of-function variants and early-onset AF (most commonly associated genetic variation with AF)
- Manifestation of atrial fibrillation occurs through [atrial myopathy]{.red}, which may be identified through different imaging modalities including [ECG]{.green} [@Verweij2020]

[__Project__]{.underline}: Using the *TTN* gene as a case study, ECG features can be extracted that classify and [identify samples with deleterious variants]{.underline}, based on *in silico predictors* (PolyPhen, SIFT, REVEL), in a population with AF.]

## ECG prediction of pathogenic TTN variants {.smaller}

[Background]{.underline}: VUS/LP/P TTN variants are associated with increased incidence of EOAF. The mechanism is not fully understood. 

[Aims]{.underline}: Identify if VUS/LP/P TTN variants may cause structural atrial changes (an atrial myopathy) that is identifiable or ECG, or other related conduction changes. We [aim to identify if VUS/LP/P TTN variants can be classified on ECG using signal processing techniques]{.red}

[Approach]{.underline}: Utilize sinus rhythm ECGs from patients with WES/CGS with paroxysmal AF. Develop beat-by-beat algorithm to identify features that may be associated with VUS/LP/P TTN variants.

## ECG data {.smaller}

- `n = 298` patients were available and had ECG in sinus rhythm at some point from 2010 to 2023
- This amounted to `n = 7953` unique ECG that were thought to be in sinus rhythm
- Using a wavelet-decomposition approach, identified morphology of P wave, QRS complex, and T wave and created single-beat structures
- Using these `n = 51493` beats, there were `n = 6202` [cases]{.red} (which represents `n = 36` individuals with potential pathogenic TTN variants (based on SIFT/PolyPhen scores)
- Convoluted neural network approach to classify cases/controls

---

```{r}
#| label: sinus rhythm
#| echo: TRUE
#| code-line-numbers: "|1|2|3"
#| output-location: fragment
fp <- system.file('extdata', package = 'shiva')
nsr <- shiva::read_wfdb('muse-sinus', record_dir = fp, annotator = 'ecgpuwave')
nsr
```

---

```{r}
#| label: sinus rhythm visualization
#| echo: TRUE
#| code-line-numbers: "|1|2|3"
#| output-location: fragment
fp <- system.file('extdata', package = 'shiva')
nsr <- read_wfdb('muse-sinus', record_dir = fp, annotator = 'ecgpuwave')
ggm(nsr)
```

---

```{r}
#| label: single beat
#| echo: TRUE
#| code-line-numbers: "|1|2|3|4"
#| output-location: fragment
fp <- system.file('extdata', package = 'shiva')
nsr <- read_wfdb('muse-sinus', record_dir = fp, annotator = 'ecgpuwave')
beats <- segmentation(nsr, by = 'sinus')
ggm(beats[[1]])
```

## Initial results

[Training]{.green}

- Training accuracy was `88%` with only `2%` loss after total of 10 steps

[Testing]{.green}

- Testing accuracy was `85%` with `13%` loss
- Example: single beat (control) may have a confidence of `75%` in being a control

---

![First 10 epochs of training](../figures/keras-accuracy-121023.png)

## Next steps

1. Evaluate model-explainability (e.g. how heavily P-wave morphology influences confidence)
1. Expand to additional genes associated with AF
1. Validate in a larger cohort
1. Correlate with intracardiac EGM findings

---

![Developed an open-source pipeline to evaluate intracardiac findings from electrophysiology studies](../figures/open-ep-voltage-map.png){#fig-open-ep-voltage-map}

# [Autonomic Influences]{.yellow}

## Review of stress

- Stress and triggers of AF
- Neurocardiac pathways

## Non-PVI ablative strategies

## Neurocardiac axis

## Stress and arrhythmias

# [Future Directions]{.red}

## Novel approaches

## K23 aims

# Questions?

## References {.tiniest}

::: {#refs}
:::
